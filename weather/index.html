<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="stylesheet/main.css">

</head>

<body>
    <div class="weather-card">
        <h3 style="color:white;">Search Weather for Your Location</h3>
      <!-- <div class="currentLocation">
        Want to know your current weather location 
        <button class="locationBtn">
            <i class="fas fa-map-marker-alt"></i> Get Location
        </button>
      </div> -->
      <div class="searchLocation">
        <form class="searchForm">
            <input type="text" name="cityName" id="cityName" class="cityInput" placeholder="Enter City Name">
            <input type="submit" value="Search" class="searchBtn">
        </form>
        <div class="error-text">Error Text</div>
      </div>
      <div class="currentLocationWeather">
        <div class="box1">
            <div class="cityDetail">
                <p class="cityName">
                    <b id="cityname"></b><br>
                    <span class="date">Current Date</span>
                </p>
                
                <img class="weather-icon">
                <p class="description">Weather Description</p>
            </div>
            <div class="temp">
                <p class="temperature">
                    <b class="tmp"></b><br>
                    Feel like
                    <span class="feellike"></span><br/><br/>
                    <i class="fas fa-tint"></i> Humidity
                    <span class="humidity"></span><br/><br/>
                    <i class="fas fa-wind"></i>
                    <span class="wind"></span>
                </p>
            </div>
        </div>

      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script>
        var currentDate = new Date(),
            currentDateString = currentDate.toDateString();
            cityNameElement = document.getElementById("cityname"),
            date = document.querySelector(".cityDetail .cityName .date"),
            weathericon = document.querySelector(".cityDetail .weather-icon"),
            description = document.querySelector(".cityDetail .description"),
            temp = document.querySelector(".temp .temperature .tmp"),
            feelLike = document.querySelector(".temperature .feellike"),
            humidity = document.querySelector(".temperature .humidity"),
            wind = document.querySelector(".temperature .wind"),
            locationBtn = document.querySelector(".locationBtn"),
            searchBtn = document.querySelector(".searchBtn"),
            searchForm = document.querySelector(".searchForm"),
            errortxt = document.querySelector(".error-text"),
            weatherBox = document.querySelector(".currentLocationWeather");
            searchForm.onsubmit = (e)=>{
                e.preventDefault();
            }

        function getWeatherForSearchCity(cityName){
            if(cityName!=""){
                errortxt.style.display = "none";
                axios.get(`https://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=56342db16786477e13abe80d38e62e0f&units=metric`)
                .then((response)=>{
                    const weatherData = response.data;
                    const url = weatherData.weather[0].icon;
                    const iconUrl = "https://openweathermap.org/img/wn/"+url+".png";
                    cityNameElement.innerHTML = weatherData.name;
                    date.innerHTML = currentDateString;
                    description.innerHTML = weatherData.weather[0].description;
                    weathericon.src = iconUrl;
                    temp.innerHTML = Math.ceil(weatherData.main.temp)+"&deg;C";
                    feelLike.innerHTML = weatherData.main.feels_like;
                    humidity.innerHTML = weatherData.main.humidity;
                    wind.innerHTML =Math.ceil((weatherData.wind.speed*3.6).toFixed(2))+" km/h";
                    weatherBox.style.display= "block";
                    document.querySelector(".cityInput").value ="";
                })
                .catch((error)=>{
                    console.log(error);
                    if (error.response && error.response.status === 404) {
                         // Handle 404 error (city not found) here
                        errortxt.innerHTML = "&#9888;"+cityName+" is Not Found";
                        errortxt.style.display = "inline-block";
                        weatherBox.style.display= "none";
                    }
                });
            }
            else {
                errortxt.innerHTML = "&#9888; Name in Input Field";
                errortxt.style.display = "inline-block";
                weatherBox.style.display= "none";
            }
        }

        searchBtn.onclick = ()=>{
            var cityInput = document.querySelector(".cityInput").value;
            getWeatherForSearchCity(cityInput);
        }
       
    </script>

</body>
</html>